from numpy import inf
temp = [inf, -1745, -1747, -1743, -1746, -1745, -1747, -1748, -1744, -1744, -1743, -1744, -1740, -1747, -1740, -1748, -1740, -1742, -1744, -1747, -1744, -1749, -1742, -1745, -1745, -1747, -1744, -1742, -1742, -1747, -1745, -1743, -1744, -1743, -1743, -1748, -1743, -1744, -1748, -1745, -1744, -1746, -1745, -1746, -1744, -1746, -1744, -1744, -1745, -1742, -1743, -1742, -1744, -1745, -1745, -1741, -1743, -1744, -1741, -1745, -1744, -1747, -1744, -1746, -1739, -1744, -1747, -1742, -1745, -1743, -1745, -1742, -1745, -1743, -1742, -1746, -1743, -1743, -1743, -1747, -1742, -1746, -1742, -1745, -1743, -1745, -1741, -1745, -1745, -1741, -1746, -1745, -1746, -1744, -1747, -1746, -1742, -1745, -1747, -1745, -1743, -1744, -1745, -1746, -1746, -1743, -1748, -1740, -1746, -1745, -1747, -1746, -1740, -1742, -1744, -1744, -1743, -1742, -1746, -1746, -1740, -1745, -1745, -1744, -1745, -1746, -1743, -1741, -1744, -1745, -1747, -1743, -1745, -1741, -1743, -1747, -1746, -1745, -1745, -1742, -1744, -1745, -1746, -1746, -1746, -1747, -1744, -1746, -1743, -1745, -1743, -1744, -1737, -1739, -1745, -1741, -1738, -1742, -1745, -1744, -1743, -1739, -1744, -1743, -1746, -1745, -1742, -1745, -1745, -1745, -1744, -1744, -1744, -1747, -1744, -1744, -1739, -1743, -1745, -1744, -1746, -1739, -1738, -1743, -1743, -1744, -1746, -1746, -1743, -1748, -1746, -1743, -1745, -1746, -1745, -1741, -1746, -1747, -1743, -1742, -1742, -1743, -1746, -1746, -1746, -1745, -1744, -1744, -1742, -1740, -1737, -1737, -1747, -1745, -1744, -1747, -1743, -1743, -1741, -1744, -1744, -1743, -1741, -1745, -1745, -1744, -1744, -1739, -1745, -1741, -1742, -1748, -1745, -1744, -1746, -1743, -1744, -1742, -1746, -1745, -1743, -1745, -1743, -1745, -1745, -1745, -1742, -1747, -1742, -1742, -1743, -1746, -1742, -1745, -1746, -1741, -1747, -1743, -1746, -1745, -1736, -1745, -1739, -1747, -1745, -1744, -1742, -1748, -1742, -1741, -1745, -1742, -1743, -1742, -1736, -1744, -1745, -1744, -1743, -1747, -1746, -1746, -1746, -1744, -1745, -1744, -1741, -1746, -1746, -1742, -1744, -1746, -1739, -1745, -1744, -1742, -1744, -1748, -1742, -1743, -1747, -1745, -1742, -1745, -1744, -1745, -1745, -1746, -1746, -1744, -1745, -1738, -1744, -1747, -1747, -1742, -1746, -1748, -1742, -1748, -1746, -1745, -1745, -1746, -1743, -1741, -1744, -1746, -1738, -1748, -1743, -1747, -1744, -1745, -1747, -1740, -1744, -1744, -1745, -1747, -1745, -1744, -1745, -1748, -1742, -1746, -1744, -1744, -1745, -1743, -1745, -1740, -1742, -1745, -1746, -1743, -1742, -1743, -1743, -1743, -1744, -1743, -1741, -1744, -1743, -1745, -1738, -1735, -1746, -1747, -1742, -1742, -1745, -1746, -1743, -1745, -1744, -1743, -1743, -1743, -1745, -1746, -1742, -1742, -1748, -1746, -1745, -1739, -1745, -1741, -1742, -1746, -1743, -1747, -1742, -1747, -1744, -1744, -1746, -1745, -1740, -1744, -1745, -1745, -1745, -1746, -1745, -1746, -1743, -1739, -1744, -1743, -1740, -1741, -1744, -1744, -1747, -1743, -1746, -1745, -1743, -1746, -1746, -1745, -1746, -1743, -1745, -1744, -1746, -1746, -1743, -1743, -1746, -1741, -1740, -1746, -1742, -1742, -1742, -1744, -1742, -1743, -1746, -1744, -1748, -1744, -1744, -1745, -1744, -1741, -1746, -1744, -1746, -1742, -1741, -1745, -1741, -1747, -1744, -1740, -1749, -1743, -1746, -1740, -1739, -1743, -1745, -1738, -1746, -1742, -1744, -1744, -1735, -1746, -1746, -1746, -1746, -1743, -1742, -1747, -1742, -1735, -1747, -1744, -1746, -1742, -1746, -1741, -1737, -1742, -1746, -1742, -1744, -1746, -1745, -1747, -1740, -1743, -1743, -1740, -1743, -1742, -1746, -1745, -1745, -1745, -1744, -1743, -1744, -1744, -1744, -1740, -1748, -1740, -1745, -1740, -1744, -1741, -1743, -1747, -1744, -1748, -1744, -1746, -1746, -1746, -1748, -1747, -1743, -1748, -1741, -1740, -1741, -1746, -1744, -1744, -1744, -1745, -1744, -1747, -1742, -1739, -1745, -1745, -1744, -1744, -1747, -1743, -1743, -1742, -1743, -1743, -1745, -1741, -1742, -1746, -1741, -1746, -1745, -1743, -1746, -1748, -1741, -1741, -1745, -1741, -1742, -1748, -1742, -1745, -1744, -1746, -1744, -1742, -1747, -1740, -1744, -1744, -1744, -1748, -1745, -1744, -1742, -1746, -1746, -1742, -1745, -1741, -1737, -1740, -1745, -1738, -1745, -1743, -1746, -1743, -1744, -1742, -1743, -1741, -1746, -1736, -1743, -1746, -1741, -1741, -1746, -1746, -1744, -1746, -1742, -1745, -1741, -1741, -1744, -1744, -1743, -1742, -1739, -1743, -1742, -1745, -1743, -1742, -1743, -1745, -1746, -1743, -1745, -1744, -1745, -1748, -1748, -1746, -1744, -1741, -1746, -1748, -1742, -1745, -1744, -1747, -1739, -1743, -1745, -1744, -1743, -1740, -1736, -1744, -1745, -1746, -1745, -1744, -1745, -1740, -1743, -1742, -1742, -1743, -1745, -1744, -1747, -1736, -1745, -1745, -1748, -1744, -1745, -1747, -1744, -1742, -1744, -1746, -1745, -1747, -1743, -1740, -1745, -1742, -1745, -1747, -1745, -1742, -1744, -1746, -1742, -1744, -1744, -1741, -1744, -1745, -1741, -1744, -1746, -1740, -1742, -1744, -1744, -1746, -1747, -1737, -1746, -1743, -1746, -1746, -1745, -1748, -1743, -1744, -1745, -1739, -1744, -1744, -1747, -1740, -1743, -1743, -1745, -1743, -1743, -1740, -1743, -1744, -1742, -1746, -1746, -1746, -1744, -1745, -1748, -1746, -1744, -1744, -1743, -1740, -1748, -1746, -1745, -1742, -1743, -1747, -1743, -1740, -1746, -1745, -1748, -1746, -1743, -1745, -1745, -1745, -1746, -1741, -1746, -1743, -1745, -1747, -1742, -1743, -1746, -1748, -1747, -1744, -1746, -1745, -1741, -1748, -1745, -1745, -1744, -1740, -1746, -1743, -1745, -1742, -1742, -1747, -1747, -1748, -1740, -1743, -1737, -1740, -1744, -1739, -1745, -1745, -1746, -1744, -1745, -1743, -1748, -1746, -1732, -1746, -1747, -1743, -1744, -1743, -1747, -1747, -1743, -1743, -1744, -1741, -1744, -1746, -1745, -1746, -1741, -1746, -1745, -1745, -1742, -1746, -1746, -1745, -1743, -1743, -1743, -1746, -1747, -1737, -1746, -1744, -1744, -1742, -1745, -1743, -1744, -1745, -1744, -1738, -1747, -1743, -1745, -1742, -1746, -1745, -1744, -1746, -1747, -1746, -1745, -1742, -1747, -1741, -1744, -1742, -1745, -1742, -1745, -1740, -1747, -1744, -1748, -1743, -1744, -1745, -1742, -1745, -1740, -1741, -1744, -1745, -1737, -1742, -1742, -1744, -1745, -1748, -1742, -1745, -1744, -1744, -1739, -1738, -1742, -1741, -1745, -1743, -1744, -1744, -1745, -1743, -1744, -1737, -1743, -1745, -1739, -1741, -1737, -1743, -1747, -1743, -1745, -1743, -1741, -1739, -1741, -1745, -1744, -1744, -1744, -1746, -1745, -1744, -1747, -1743, -1747, -1745, -1744, -1743, -1746, -1744, -1745, -1744, -1742, -1744, -1744, -1743, -1740, -1743, -1746, -1742, -1742, -1745, -1744, -1747, -1745, -1745, -1743, -1738, -1741, -1744, -1747, -1740, -1739, -1743, -1746, -1748, -1743, -1739, -1744, -1744, -1744, -1738, -1746, -1743, -1743, -1743, -1746, -1741, -1741, -1746, -1738, -1744, -1738, -1744, -1739, -1742, -1741, -1743, -1745, -1745, -1747, -1743, -1741, -1743, -1746, -1745, -1744, -1741, -1746, -1744, -1742, -1740, -1743, -1740, -1743, -1743, -1746, -1746, -1747, -1742, -1745, -1742, -1740, -1745, -1748, -1743, -1743, -1746, -1746, -1744, -1744, -1735, -1741, -1745, -1740, 0]


def Johnsons(edges, n, m):
#-----------------------------------------------
#Johnson's algorithm: 
#Finds all-pairs shortest path distances
#Create new graph with new node, s, with edges to all other nodes length 0
#Run Bellman Ford and compute shortest paths from s to all other nodes
#assign each vertex, v, a weight, Pv, that is it's shortest path from s
#Create new set of edges: for c(u,v) in G, c'(u,v) = c + Pu - Pv
#run Dijkstra's algorithm for each vertex in G to every other vertex with edge lengths c'
#unweight the distances, i.e. each d(u,v) = d'(u,v) - Pu + Pv
#------------------------------------------------
    from DijkstrasCustomHeap import Dijkstras
    
    #Create new graph with new node, s, with edges to all other nodes length 0
    edges_with_s = edges[:]
    for i in range(1, n+1):
        edges_with_s.append([n+1, i, 0])
    #Run Bellman Ford and compute shortest paths from s to all other nodes
    shortest_paths_from_s = temp 
        #(edges, num verticies, vertex taking shortest path from)
    #output of BellmanFord is list of distances from s (zero indexed)
    #assign each vertex, v, a weight, Pv, that is it's shortest path from s
    weights = dict()
    for i in range(1, n+1):
        weights[i] = shortest_paths_from_s[i]
    #Create new set of edges: for c(u,v) in G, c'(u,v) = c + Pu - Pv
    weighted_edges = edges[:]
    for edge in weighted_edges:
        edge = edge[0:2] + [edge[2] + weights[edge[0]] - weights[edge[1]]]
    #run Dijkstra's algorithm for each vertex in G to every other vertex with edge lengths c'
    #transform weighted_edges into graph for Dijkstra
    a = {}
    for edge in weighted_edges:
        if edge[0] in a:
            a[edge[0]][edge[1]] = edge[2]
        else:
            a[edge[0]] = {}
            a[edge[0]][edge[1]] = edge[2]
    # a is graph of the form {node1: {node2: distance, node3: distance, ... }, ...}
    res = [[]]*(n+1) #index goes from 0 to n
    for i in range(1, n+1):
        res[i] = Dijkstras(a, n, i)
            #(graph, num verticies, vertex taking shortest path from)
        print("Dijkstra complete for ", i)
        #output of Dijkstras is a n-length list of shortest paths from vertex i
    #unweight the distances, i.e. each d(u,v) = d'(u,v) - Pu + Pv
    for i in range(1, n+1):
        for j in range(1, n+1):
            res[i][j] = res[i][j] - weights[i] + weights[j]
    return res

if __name__ == '__main__':
    edges = []
    for line in open('g1.txt', 'r'):
        edges.append(list(map(int, line.split())))
    n = edges[0][0] #number of verticies
    m = edges[0][1] #number of edges
    edges = edges[1:]
    #'edges' is a list of lists of form [tail, head, length]
    #graph is list of directed edges in form [tail, head, length]
    print(edges[0], n, m)
    import time
    start = time.time()
    s = Johnsons(edges, n, m)
    stop = time.time()
    total = stop - start
    print('time to run: ', total)
    print(s[1][1], s[1][2])